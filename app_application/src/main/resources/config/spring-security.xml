<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:security="http://www.springframework.org/schema/security"
       xmlns:p="http://www.springframework.org/schema/p" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
          http://www.springframework.org/schema/beans/spring-beans-4.1.xsd  
          http://www.springframework.org/schema/security  
          http://www.springframework.org/schema/security/spring-security-4.1.xsd">


    <security:http pattern="/javascript/**" security="none"/>
    <security:http pattern="/swf/**" security="none"/>
    <security:http pattern="/resources/**" security="none"/>
    <security:http pattern="/app/**" security="none"/>
    <security:http pattern="/static/**" security="none"/>
    <security:http pattern="/login/*" security="none"/>
    <!-- use-expressions:Spring 表达式语言配置访问控制 -->
    <security:http auto-config="true" use-expressions="true">

        <security:session-management>
            <security:concurrency-control max-sessions="1"
                                          error-if-maximum-exceeded="true"/>
        </security:session-management>
        <security:csrf disabled="true"/>
        <security:form-login authentication-details-source-ref="customAuthenticationDetailsSource"
                             login-page="/login/form" login-processing-url="/login"
                             username-parameter="username" password-parameter="password"
                             authentication-failure-url="/login/form?error" default-target-url="/"/>

        <security:intercept-url pattern="/logout" access="IS_AUTHENTICATED_ANONYMOUSLY"/>
        <security:intercept-url pattern="/errors/**" access="IS_AUTHENTICATED_ANONYMOUSLY"/>
        <!--
            <intercept-url pattern="/events/" access="hasRole('ROLE_ADMIN')"/>
            <intercept-url pattern="/admin/**" access="hasRole('ROLE_ADMIN')"/>
        -->
        <security:intercept-url pattern="/**" access="isFullyAuthenticated()"/>
        <security:access-denied-handler error-page="/errors/403"/>
        <security:headers>
            <security:frame-options policy="SAMEORIGIN"/>
        </security:headers>
    </security:http>

    <security:authentication-manager alias="authenticationManager">
        <security:authentication-provider ref="customAuthenticationProvider"/>
    </security:authentication-manager>
</beans>